(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 12.2' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     31280,        659]
NotebookOptionsPosition[     30925,        645]
NotebookOutlinePosition[     31324,        661]
CellTagsIndexPosition[     31281,        658]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"SetDirectory", "[", 
    RowBox[{"NotebookDirectory", "[", "]"}], "]"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"TR", "[", 
     RowBox[{"a_", ",", "b_"}], "]"}], ":=", 
    RowBox[{"Thread", "[", 
     RowBox[{"Rule", "[", 
      RowBox[{"a", ",", "b"}], "]"}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"DD", ":=", "DeleteDuplicates"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Acc", "[", 
   RowBox[{"a_", ",", "atrue_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"100", "-", 
    RowBox[{
     RowBox[{"Abs", "[", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"a", "-", "atrue"}], ")"}], "/", "atrue"}], "]"}], "*", 
     "100"}]}], "//", "Mean"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"PE", "[", 
   RowBox[{"a_", ",", "atrue_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{
    RowBox[{"Abs", "[", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"a", "-", "atrue"}], ")"}], "/", "atrue"}], "]"}], "*", 
    "100"}], "//", "Mean"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"RMSE", "[", 
     RowBox[{"as_", ",", "bs_"}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", "rmse", "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"rmse", "=", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Total", "[", 
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{"as", "-", "bs"}], ")"}], "2"], "]"}], "/", 
           RowBox[{"Length", "[", "as", "]"}]}], ")"}], 
         RowBox[{"1", "/", "2"}]]}], ";", "\[IndentingNewLine]", 
       RowBox[{"Return", "[", "rmse", "]"}]}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"GetTrainTestSplit", "[", 
     RowBox[{"mat0_", ",", "smallyieldfrac_", ",", "trainfrac_"}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "mat", ",", "inputs", ",", "outputs", ",", "outs", ",", "pos1", ",", 
        "pos", ",", "L", ",", "tr", ",", "te", ",", "trSetIn", ",", 
        "trSetOut", ",", "testSetIn", ",", "testSetOut", ",", "indim", ",", 
        "outdim"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"mat", "=", "mat0"}], ";", "\[IndentingNewLine]", 
       RowBox[{"inputs", "=", 
        RowBox[{"mat", "[", 
         RowBox[{"[", 
          RowBox[{";;", ",", 
           RowBox[{"1", ";;", 
            RowBox[{"-", "2"}]}]}], "]"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"outputs", "=", 
        RowBox[{"mat", "[", 
         RowBox[{"[", 
          RowBox[{";;", ",", 
           RowBox[{"-", "1"}]}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"outputs", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"{", "#", "}"}], "&"}], "/@", "outputs"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"outs", "=", 
        RowBox[{"Select", "[", 
         RowBox[{"outputs", ",", 
          RowBox[{
           RowBox[{
            RowBox[{"#", "[", 
             RowBox[{"[", "1", "]"}], "]"}], "\[LessEqual]", 
            "smallyieldfrac"}], "&"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
       
       RowBox[{"pos1", "=", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"Position", "[", 
               RowBox[{"outputs", ",", "#"}], "]"}], "&"}], "/@", "outs"}], 
            ")"}], "//", "Flatten"}], "//", "DD"}], "//", "Sort"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"pos", "=", 
        RowBox[{"Complement", "[", 
         RowBox[{
          RowBox[{"Range", "[", 
           RowBox[{"Length", "[", "inputs", "]"}], "]"}], ",", "pos1"}], 
         "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"inputs", "=", 
        RowBox[{"inputs", "[", 
         RowBox[{"[", "pos", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"outputs", "=", 
        RowBox[{"outputs", "[", 
         RowBox[{"[", "pos", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"L", "=", 
        RowBox[{"Length", "[", "inputs", "]"}]}], ";", "\[IndentingNewLine]", 
       
       RowBox[{"tr", "=", 
        RowBox[{"RandomSample", "[", 
         RowBox[{
          RowBox[{"Range", "[", "L", "]"}], ",", 
          RowBox[{"Floor", "[", 
           RowBox[{"trainfrac", "*", "L"}], "]"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"te", "=", 
        RowBox[{"Complement", "[", 
         RowBox[{
          RowBox[{"Range", "[", "L", "]"}], ",", "tr"}], "]"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"trSetIn", "=", 
        RowBox[{"N", "[", 
         RowBox[{"inputs", "[", 
          RowBox[{"[", "tr", "]"}], "]"}], "]"}]}], ";", 
       RowBox[{"trSetOut", "=", 
        RowBox[{"N", "[", 
         RowBox[{"outputs", "[", 
          RowBox[{"[", "tr", "]"}], "]"}], "]"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"testSetIn", "=", 
        RowBox[{"N", "[", 
         RowBox[{"inputs", "[", 
          RowBox[{"[", "te", "]"}], "]"}], "]"}]}], ";", 
       RowBox[{"testSetOut", "=", 
        RowBox[{"N", "[", 
         RowBox[{"outputs", "[", 
          RowBox[{"[", "te", "]"}], "]"}], "]"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"indim", "=", 
        RowBox[{"Dimensions", "[", 
         RowBox[{"trSetIn", "[", 
          RowBox[{"[", "1", "]"}], "]"}], "]"}]}], ";", 
       RowBox[{"outdim", "=", 
        RowBox[{"Dimensions", "[", 
         RowBox[{"trSetOut", "[", 
          RowBox[{"[", "1", "]"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"Return", "[", 
        RowBox[{"{", 
         RowBox[{
         "inputs", ",", "outputs", ",", "indim", ",", "outdim", ",", 
          "trSetIn", ",", "trSetOut", ",", "testSetIn", ",", "testSetOut"}], 
         "}"}], "]"}]}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"NeuralNetArch", "[", 
     RowBox[{
     "indim_", ",", "outdim_", ",", "numnodes_", ",", "act_", ",", 
      "finalact_", ",", "dropout_", ",", "dropoutamount_", ",", "numlayers_", 
      ",", "maxtrainrounds_", ",", "trSetIn_", ",", "trSetOut_", ",", 
      "batchsize_", ",", "lr_", ",", "optmeth_"}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"nn0", ",", "tnn", ",", "nn"}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"dropout", "\[Equal]", "1"}], ",", 
         RowBox[{"nn", "=", 
          RowBox[{"Apply", "[", 
           RowBox[{"NetChain", ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"Flatten", "[", 
               RowBox[{"Join", "[", 
                RowBox[{
                 RowBox[{"Table", "[", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"LinearLayer", "[", "numnodes", "]"}], ",", 
                    RowBox[{"ElementwiseLayer", "[", "act", "]"}], ",", 
                    RowBox[{"DropoutLayer", "[", "dropoutamount", "]"}]}], 
                    "}"}], ",", 
                   RowBox[{"{", 
                    RowBox[{"numlayers", "-", "1"}], "}"}]}], "]"}], ",", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"LinearLayer", "[", "outdim", "]"}], ",", 
                   RowBox[{"ElementwiseLayer", "[", "finalact", "]"}]}], 
                  "}"}]}], "]"}], "]"}], ",", 
              RowBox[{"\"\<Input\>\"", "\[Rule]", "indim"}], ",", 
              RowBox[{"\"\<Output\>\"", "\[Rule]", "outdim"}]}], "}"}]}], 
           "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"dropout", "\[Equal]", "0"}], ",", 
         RowBox[{"nn", "=", 
          RowBox[{"Apply", "[", 
           RowBox[{"NetChain", ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"Flatten", "[", 
               RowBox[{"Join", "[", 
                RowBox[{
                 RowBox[{"Table", "[", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"LinearLayer", "[", "numnodes", "]"}], ",", 
                    RowBox[{"ElementwiseLayer", "[", "act", "]"}]}], "}"}], 
                   ",", 
                   RowBox[{"{", 
                    RowBox[{"numlayers", "-", "1"}], "}"}]}], "]"}], ",", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"LinearLayer", "[", "outdim", "]"}], ",", 
                   RowBox[{"ElementwiseLayer", "[", "finalact", "]"}]}], 
                  "}"}]}], "]"}], "]"}], ",", 
              RowBox[{"\"\<Input\>\"", "\[Rule]", "indim"}], ",", 
              RowBox[{"\"\<Output\>\"", "\[Rule]", "outdim"}]}], "}"}]}], 
           "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"nn", "=", 
        RowBox[{"NetInitialize", "[", 
         RowBox[{"nn", ",", 
          RowBox[{"Method", "\[Rule]", " ", "\"\<Kaiming\>\""}]}], "]"}]}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{"nn0", "=", "nn"}], ";", "\[IndentingNewLine]", 
       RowBox[{"tnn", "=", 
        RowBox[{"NetTrain", "[", 
         RowBox[{"nn", ",", 
          RowBox[{"trSetIn", "\[Rule]", "trSetOut"}], ",", 
          RowBox[{"MaxTrainingRounds", "\[Rule]", "maxtrainrounds"}], ",", 
          RowBox[{"BatchSize", "\[Rule]", "batchsize"}], ",", 
          RowBox[{"LearningRate", "\[Rule]", "lr"}], ",", 
          RowBox[{"Method", "\[Rule]", "optmeth"}]}], 
         RowBox[{"(*", 
          RowBox[{",", 
           RowBox[{"ValidationSet", "\[Rule]", "Automatic"}]}], "*)"}], 
         "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"Return", "[", 
        RowBox[{"{", 
         RowBox[{"nn0", ",", "tnn"}], "}"}], "]"}]}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Benchmarks", "[", 
     RowBox[{
     "tnn_", ",", "trSetIn_", ",", "trSetOut_", ",", "testSetIn_", ",", 
      "testSetOut_", ",", "smallyieldfrac_"}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "A", ",", "B", ",", "A1", ",", "B1", ",", "x", ",", "y", ",", "z", ",",
         "w"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"{", 
         RowBox[{"A", ",", "B", ",", "A1", ",", "B1"}], "}"}], "=", 
        RowBox[{"Flatten", "/@", 
         RowBox[{"{", 
          RowBox[{"trSetOut", ",", 
           RowBox[{"tnn", "[", "trSetIn", "]"}], ",", "testSetOut", ",", 
           RowBox[{"tnn", "[", "testSetIn", "]"}]}], "}"}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", "Benchmarks", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"x", "=", 
        RowBox[{
         RowBox[{"100.", "*", 
          RowBox[{"(", 
           RowBox[{"Abs", "[", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"Flatten", "[", "trSetOut", "]"}], "-", 
               RowBox[{"Flatten", "[", 
                RowBox[{"tnn", "[", "trSetIn", "]"}], "]"}]}], ")"}], "/", 
             RowBox[{"Flatten", "[", "trSetOut", "]"}]}], "]"}], ")"}]}], "//",
          "Mean"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"y", "=", 
        RowBox[{
         RowBox[{"100.", "*", 
          RowBox[{"(", 
           RowBox[{"Abs", "[", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"Flatten", "[", "testSetOut", "]"}], "-", 
               RowBox[{"Flatten", "[", 
                RowBox[{"tnn", "[", "testSetIn", "]"}], "]"}]}], ")"}], "/", 
             RowBox[{"Flatten", "[", "testSetOut", "]"}]}], "]"}], ")"}]}], "//",
          "Mean"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"z", "=", 
        RowBox[{"RMSE", "[", 
         RowBox[{
          RowBox[{"trSetOut", "//", "Flatten"}], ",", 
          RowBox[{
           RowBox[{"tnn", "[", "trSetIn", "]"}], "//", "Flatten"}]}], "]"}]}],
        ";", "\[IndentingNewLine]", 
       RowBox[{"w", "=", 
        RowBox[{"RMSE", "[", 
         RowBox[{
          RowBox[{"testSetOut", "//", "Flatten"}], ",", 
          RowBox[{
           RowBox[{"tnn", "[", "testSetIn", "]"}], "//", "Flatten"}]}], 
         "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"Return", "[", 
        RowBox[{"{", 
         RowBox[{"x", ",", "y", ",", "z", ",", "w"}], "}"}], "]"}], ";"}]}], 
     "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MLExperiments", "[", 
    RowBox[{
    "datapath_", ",", "dataflag_", ",", "smallyieldfrac_", ",", "numlayers_", 
     ",", "ACT_", ",", "dropout_", ",", "dropoutamount_", ",", 
     "maxtrainrounds_", ",", "batchsize_", ",", "lr_", ",", "optmeth_", ",", 
     "trainfrac_", ",", "numnodes_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "strrr", ",", "str", ",", "\[Alpha]", ",", "\[Beta]", ",", "mat", ",", 
       "inputs", ",", "outputs", ",", "indim", ",", "outdim", ",", "trSetIn", 
       ",", "trSetOut", ",", "testSetIn", ",", "testSetOut", ",", "func", ",",
        "finalact", ",", "act", ",", "nn0", ",", "tnn", ",", "trpreds", ",", 
       "testpreds", ",", "corrtr", ",", "corrte", ",", "pred", ",", "x", ",", 
       "y", ",", "z", ",", "w"}], "}"}], ",", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"{", 
        RowBox[{"\[Alpha]", ",", "\[Beta]"}], "}"}], "=", "dataflag"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"strrr", "=", 
       RowBox[{"\"\<_dataflag_\>\"", "<>", 
        RowBox[{"ToString", "[", "\[Alpha]", "]"}], "<>", "\"\<_\>\"", "<>", 
        RowBox[{"ToString", "[", "\[Beta]", "]"}], "<>", 
        "\"\<_trainfrac_\>\"", "<>", 
        RowBox[{"ToString", "[", "trainfrac", "]"}], "<>", 
        "\"\<_numlayers_\>\"", "<>", 
        RowBox[{"ToString", "[", "numlayers", "]"}], "<>", 
        "\"\<_smallyieldfrac_\>\"", "<>", 
        RowBox[{"ToString", "[", "smallyieldfrac", "]"}], "<>", 
        "\"\<_DO_\>\"", "<>", 
        RowBox[{"ToString", "[", "dropoutamount", "]"}], "<>", 
        "\"\<_MaxRounds_\>\"", "<>", 
        RowBox[{"ToString", "[", "maxtrainrounds", "]"}], "<>", 
        "\"\<_batchsize_\>\"", "<>", 
        RowBox[{"ToString", "[", "batchsize", "]"}], "<>", "\"\<_lr_\>\"", "<>", 
        RowBox[{"ToString", "[", "lr", "]"}], "<>", "\"\<_optmeth_\>\"", "<>", 
        RowBox[{"ToString", "[", "optmeth", "]"}]}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"str", "=", 
       RowBox[{"datapath", "<>", "\"\<DMAT_\>\"", "<>", 
        RowBox[{"ToString", "[", "\[Alpha]", "]"}], "<>", "\"\<_\>\"", "<>", 
        RowBox[{"ToString", "[", "\[Beta]", "]"}], "<>", "\"\<.csv\>\""}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"mat", "=", 
       RowBox[{
        RowBox[{"ToExpression", "[", 
         RowBox[{"Import", "[", "str", "]"}], "]"}], "//", "N"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"mat", "[", 
        RowBox[{"[", 
         RowBox[{";;", ",", 
          RowBox[{"-", "1"}]}], "]"}], "]"}], "=", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"mat", "[", 
          RowBox[{"[", 
           RowBox[{";;", ",", 
            RowBox[{"-", "1"}]}], "]"}], "]"}], "/", "100"}], ")"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "inputs", ",", "outputs", ",", "indim", ",", "outdim", ",", "trSetIn",
          ",", "trSetOut", ",", "testSetIn", ",", "testSetOut"}], "}"}], "=", 
       
       RowBox[{"GetTrainTestSplit", "[", 
        RowBox[{"mat", ",", "smallyieldfrac", ",", "trainfrac"}], "]"}]}], 
      ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{"hyperparameters", " ", "for", " ", "network", " ", "choice"}],
        "*)"}], "\[IndentingNewLine]", 
      RowBox[{"Print", "[", "\"\<Neural network Regression: \>\"", "]"}], ";",
       "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"func", "[", "x_", "]"}], ":=", 
       RowBox[{"ACT", "[", "x", "]"}]}], ";", 
      RowBox[{
       RowBox[{"finalact", "[", "x_", "]"}], ":=", "x"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"act", "=", "func"}], ";", "\[IndentingNewLine]", 
      RowBox[{"(*", "*)"}], "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"nn0", ",", "tnn"}], "}"}], "=", 
       RowBox[{"NeuralNetArch", "[", 
        RowBox[{
        "indim", ",", "outdim", ",", "numnodes", ",", "act", ",", "finalact", 
         ",", "dropout", ",", "dropoutamount", ",", "numlayers", ",", 
         "maxtrainrounds", ",", "trSetIn", ",", "trSetOut", ",", "batchsize", 
         ",", "lr", ",", "optmeth"}], "]"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"trpreds", "=", 
       RowBox[{"tnn", "[", "trSetIn", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"testpreds", "=", 
       RowBox[{"tnn", "[", "testSetIn", "]"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"corrtr", "=", 
       RowBox[{"Correlation", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"tnn", "[", "trSetIn", "]"}], "//", "Flatten"}], ",", 
         RowBox[{"trSetOut", "//", "Flatten"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"corrte", "=", 
       RowBox[{"Correlation", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"tnn", "[", "testSetIn", "]"}], "//", "Flatten"}], ",", 
         RowBox[{"testSetOut", "//", "Flatten"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"x", ",", "y", ",", "z", ",", "w"}], "}"}], "=", 
       RowBox[{"Benchmarks", "[", 
        RowBox[{
        "tnn", ",", "trSetIn", ",", "trSetOut", ",", "testSetIn", ",", 
         "testSetOut", ",", "smallyieldfrac"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Print", "[", 
       RowBox[{"\"\<accuracy, rmse, corr: (train) \>\"", ",", 
        RowBox[{"100", "-", "x"}], ",", "\"\< \>\"", ",", "z", ",", 
        "\"\< \>\"", ",", "corrtr"}], "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"Print", "[", 
       RowBox[{"\"\<accuracy, rmse, corr: (test) \>\"", ",", 
        RowBox[{"100", "-", "y"}], ",", "\"\< \>\"", ",", "w", ",", 
        "\"\< \>\"", ",", "corrte"}], "]"}], ";"}]}], "]"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.82291892731248*^9, 3.822918938711426*^9}, {
   3.822919053903894*^9, 3.822919059215315*^9}, {3.833571785526696*^9, 
   3.833571786131221*^9}, {3.833573002391564*^9, 3.833573002795271*^9}, {
   3.833573861471855*^9, 3.833573869062499*^9}, {3.833573963708518*^9, 
   3.8335739641899242`*^9}, {3.83357401465809*^9, 3.833574015026394*^9}, 
   3.833574175571576*^9, {3.833574236579342*^9, 3.833574286336347*^9}, {
   3.833574334534042*^9, 3.833574338018199*^9}, {3.833574769261528*^9, 
   3.833574772281087*^9}, {3.833574811498653*^9, 3.833574811907028*^9}, {
   3.833574915375525*^9, 3.833574926602849*^9}, {3.833574993645516*^9, 
   3.8335749942073717`*^9}, {3.8335751991343317`*^9, 3.833575199458447*^9}, 
   3.833577970372486*^9, {3.833578208684127*^9, 3.833578235286007*^9}, {
   3.833578554378986*^9, 3.833578694751377*^9}, {3.833578785811968*^9, 
   3.8335787908376207`*^9}, 3.8335788577633047`*^9, {3.833579057584571*^9, 
   3.833579058499192*^9}, {3.83357913175233*^9, 3.833579132195883*^9}, {
   3.833580326850541*^9, 3.83358035827487*^9}, 3.8335804865699263`*^9, 
   3.83358055104635*^9, {3.833580701042281*^9, 3.8335807240297318`*^9}, {
   3.833612565633584*^9, 3.8336125660084457`*^9}, {3.834950953898779*^9, 
   3.834950955241015*^9}, {3.834952854091161*^9, 3.834952857203351*^9}, {
   3.8349532075891733`*^9, 3.834953216505526*^9}, {3.8349534971279593`*^9, 
   3.8349535006908913`*^9}, {3.834953985927224*^9, 3.834954015006257*^9}, {
   3.834954152304632*^9, 3.8349541997402477`*^9}, {3.834954265678591*^9, 
   3.834954266348691*^9}, 3.834954321134171*^9, {3.834954595149472*^9, 
   3.834954606847416*^9}, 3.8349546755496063`*^9, 3.834983785110763*^9, {
   3.836569966856316*^9, 3.836569977194558*^9}, {3.836570138021207*^9, 
   3.836570139130715*^9}, {3.8365702168257093`*^9, 3.8365702172982607`*^9}, {
   3.836570570864674*^9, 3.836570571407571*^9}, {3.83657062947202*^9, 
   3.8365706472261057`*^9}, {3.836570720500523*^9, 3.8365707208670692`*^9}, 
   3.836570756639802*^9, {3.836570857481099*^9, 3.836570857879223*^9}, {
   3.83657088941296*^9, 3.8365708954310923`*^9}, {3.836570926087343*^9, 
   3.836570932008357*^9}, {3.8365709889595213`*^9, 3.8365710024623623`*^9}, {
   3.836571221115782*^9, 3.836571224068408*^9}, 3.837104838437644*^9, {
   3.837105874737114*^9, 3.837105890149848*^9}, {3.837106813531578*^9, 
   3.837106821264048*^9}, 3.83710687474502*^9, {3.837107106543432*^9, 
   3.837107116443873*^9}, {3.837107935322708*^9, 3.83710794566887*^9}, {
   3.837108282751958*^9, 3.837108294878577*^9}, {3.8371083450252028`*^9, 
   3.837108359827162*^9}, {3.837108437665577*^9, 3.837108445160356*^9}, {
   3.8371084888581333`*^9, 3.837108489067071*^9}, {3.837109154960753*^9, 
   3.8371091559937572`*^9}, {3.837114350831015*^9, 3.8371143603453608`*^9}, {
   3.837116064712778*^9, 3.837116091304866*^9}, {3.83711612577065*^9, 
   3.8371161487329206`*^9}, {3.837117720542863*^9, 3.837117727033885*^9}, {
   3.837117846939899*^9, 3.837117850790717*^9}, {3.838872601582807*^9, 
   3.838872612317545*^9}, {3.838872842053946*^9, 3.838872848195794*^9}, {
   3.838872882445706*^9, 3.8388730764970007`*^9}, {3.838873113349483*^9, 
   3.838873229365987*^9}, {3.838873665719289*^9, 3.838873669402359*^9}, {
   3.838873702734007*^9, 3.8388737702522593`*^9}, {3.838873814792094*^9, 
   3.838873823142057*^9}, {3.83887392974924*^9, 3.8388739474085417`*^9}, {
   3.838873977524835*^9, 3.838873998366056*^9}, {3.8388740293063*^9, 
   3.838874054363386*^9}, {3.838874138827602*^9, 3.838874142971916*^9}, {
   3.8388741790214453`*^9, 3.838874196387999*^9}, {3.838874239585305*^9, 
   3.8388742777173357`*^9}, {3.838874316107626*^9, 3.838874320576942*^9}, {
   3.838874506541626*^9, 3.8388745561219683`*^9}, {3.838874614397332*^9, 
   3.83887462702738*^9}, {3.838874725266841*^9, 3.838874739241866*^9}, {
   3.838874794592667*^9, 3.8388748941396847`*^9}, {3.838874943544886*^9, 
   3.838874998755312*^9}, 3.838875407281474*^9, {3.838875762291547*^9, 
   3.838875838865459*^9}, {3.838875930544877*^9, 3.838875936489009*^9}, {
   3.8388759789752827`*^9, 3.838875995640564*^9}, 3.838876093065543*^9, {
   3.838877195609128*^9, 3.8388772001059732`*^9}, {3.838877230708641*^9, 
   3.838877285341497*^9}, {3.838893331286586*^9, 3.8388933372734222`*^9}, {
   3.839272742356422*^9, 3.8392727767986097`*^9}, {3.839272858975823*^9, 
   3.8392728599430656`*^9}, {3.83927707706006*^9, 3.839277077769965*^9}, {
   3.839277800013608*^9, 3.8392779833052464`*^9}, {3.839278086406807*^9, 
   3.839278104882782*^9}, {3.8392782346826563`*^9, 3.839278301566043*^9}, {
   3.8392785696169977`*^9, 3.839278653769236*^9}, {3.839278813837409*^9, 
   3.83927881767334*^9}, {3.839278868450562*^9, 3.839278872629974*^9}, {
   3.839279699323045*^9, 3.839279727316678*^9}, {3.839279767053385*^9, 
   3.839279799591213*^9}, {3.83927989890866*^9, 3.839279954992156*^9}, {
   3.839280073088086*^9, 3.839280074325014*^9}, 3.839280106241645*^9, {
   3.8392801971028833`*^9, 3.839280218819765*^9}, {3.8392802525048437`*^9, 
   3.839280315411512*^9}, {3.839280376723846*^9, 3.839280520062586*^9}, {
   3.839280568157909*^9, 3.839280632406283*^9}, {3.839280669596569*^9, 
   3.839280711984922*^9}, 3.839280757015177*^9, {3.83928081022266*^9, 
   3.839280873315556*^9}, {3.839280963851448*^9, 3.8392809820677347`*^9}, {
   3.839281264496853*^9, 3.839281268335454*^9}, {3.839281328901636*^9, 
   3.839281349587385*^9}, {3.839281438042437*^9, 3.839281474206211*^9}, {
   3.839281613182715*^9, 3.8392816146003437`*^9}, {3.839283178570006*^9, 
   3.839283205067297*^9}, {3.839283497168723*^9, 3.839283502066874*^9}, 
   3.839283543764071*^9, {3.839283638022471*^9, 3.839283682624799*^9}, {
   3.83928392051016*^9, 3.839283920733304*^9}, {3.839284099470859*^9, 
   3.839284127018955*^9}, {3.84004654480863*^9, 3.840046584332478*^9}, {
   3.8400476950243387`*^9, 3.840047748250751*^9}, {3.840048569849461*^9, 
   3.8400486049823017`*^9}, {3.840048755819852*^9, 3.840048787237204*^9}, {
   3.8400488805371323`*^9, 3.8400489272781076`*^9}, {3.840048987422531*^9, 
   3.8400490046188393`*^9}, {3.8400495579756117`*^9, 
   3.8400495763858624`*^9}, {3.8400496578395033`*^9, 3.840049686367407*^9}, {
   3.840049812417225*^9, 3.840049827870874*^9}, {3.840049930230082*^9, 
   3.840049998235392*^9}, {3.840050252342331*^9, 3.840050310706867*^9}, {
   3.8400503594865227`*^9, 3.8400503616550903`*^9}, {3.840050448816807*^9, 
   3.840050489628619*^9}, {3.8400507058881483`*^9, 3.840050721538329*^9}, {
   3.840050767417684*^9, 3.840050773215626*^9}, {3.840051009719983*^9, 
   3.8400510479669037`*^9}, 3.8400513722938147`*^9, {3.840051730870438*^9, 
   3.840051733906901*^9}, {3.840051807470536*^9, 3.840051829960026*^9}, 
   3.840051992973068*^9, 3.840052080911887*^9, {3.8400525865032253`*^9, 
   3.840052602506982*^9}, {3.840052647305367*^9, 3.8400526585681334`*^9}, {
   3.8400527208749323`*^9, 3.840052723238256*^9}, {3.840053289888277*^9, 
   3.840053323199726*^9}, {3.8400534722435417`*^9, 3.840053473008601*^9}, {
   3.840053518559959*^9, 3.840053520035738*^9}, {3.840054095487368*^9, 
   3.840054144578656*^9}, {3.8400542345162153`*^9, 3.840054344714449*^9}, {
   3.840054865458956*^9, 3.840054874604147*^9}, {3.840054973418282*^9, 
   3.8400549737004337`*^9}, {3.840055313604195*^9, 3.840055351003531*^9}, {
   3.840057594420569*^9, 3.84005759582508*^9}, {3.840057800282214*^9, 
   3.8400578076724577`*^9}, {3.840057924383144*^9, 3.840057938636114*^9}, {
   3.840058018864553*^9, 3.8400580356316338`*^9}, {3.840058111375743*^9, 
   3.840058146098524*^9}, {3.840058390199758*^9, 3.840058436171669*^9}, {
   3.840132492718844*^9, 3.840132507837494*^9}, {3.840132652295776*^9, 
   3.840132661817562*^9}, {3.8401328266781588`*^9, 3.8401328336684923`*^9}, {
   3.8401335169373217`*^9, 3.840133525368154*^9}, {3.8401336177438803`*^9, 
   3.840133700459098*^9}, {3.840133856268291*^9, 3.840133861564891*^9}, {
   3.840133987197773*^9, 3.840133998084084*^9}, 3.840189975004528*^9, 
   3.840193480733643*^9, {3.840202139296772*^9, 3.8402021437369347`*^9}, 
   3.840202325294589*^9, {3.8402042139398947`*^9, 3.8402042192694607`*^9}, {
   3.8402200639942417`*^9, 3.840220076257525*^9}, {3.840220279320703*^9, 
   3.8402202796802063`*^9}, {3.840221955128869*^9, 3.8402219588242807`*^9}, {
   3.840222039273869*^9, 3.840222058865018*^9}, {3.840222137023505*^9, 
   3.840222189786064*^9}, {3.840222270703497*^9, 3.840222302366255*^9}, {
   3.8402223344118357`*^9, 3.840222466163628*^9}, {3.840222594668239*^9, 
   3.840222733297359*^9}, {3.840222804471693*^9, 3.8402228108659983`*^9}, {
   3.84022284167916*^9, 3.840222922972426*^9}, {3.840222988315468*^9, 
   3.840222995203973*^9}, {3.840223031763404*^9, 3.840223062486474*^9}, {
   3.840223247457662*^9, 3.840223252575225*^9}, {3.840224480502754*^9, 
   3.840224496905682*^9}, {3.8402245739855967`*^9, 3.840224613550959*^9}, {
   3.840224711873006*^9, 3.84022480895819*^9}, {3.8402248603874807`*^9, 
   3.840224949321373*^9}, {3.840225960966876*^9, 3.840225983435012*^9}, {
   3.840226339389454*^9, 3.84022654199754*^9}, {3.8402265724664707`*^9, 
   3.8402265825163183`*^9}, {3.840226621672452*^9, 3.840226662154715*^9}, 
   3.8402266970999947`*^9, {3.840226754617292*^9, 3.8402267854525213`*^9}, {
   3.840226879191729*^9, 3.840226942314831*^9}, {3.8402269761284647`*^9, 
   3.840227016037834*^9}, {3.840227058764835*^9, 3.840227084090892*^9}, {
   3.84022713582692*^9, 3.840227137029743*^9}, {3.840227480678013*^9, 
   3.8402274814896517`*^9}, {3.849710625255898*^9, 3.849710636267948*^9}, {
   3.849710666821578*^9, 3.849710722174942*^9}, {3.849711310686735*^9, 
   3.8497114663196287`*^9}, {3.84971199854932*^9, 3.849712026495986*^9}, {
   3.849712376526058*^9, 3.8497124166623983`*^9}, {3.849712631040058*^9, 
   3.84971267784072*^9}, {3.849712736189735*^9, 3.8497127457791653`*^9}, {
   3.8497189976339827`*^9, 3.849719001749576*^9}, 3.849719085968494*^9, {
   3.849720218597829*^9, 3.849720225171707*^9}, 3.849721664042055*^9, {
   3.8497246064565573`*^9, 3.8497246138154173`*^9}, {3.84978562194769*^9, 
   3.849785638605283*^9}, {3.864120293063079*^9, 3.864120441916448*^9}, {
   3.86412053239424*^9, 3.8641205375570917`*^9}, {3.864120860241673*^9, 
   3.864120903603163*^9}, 3.864120956352374*^9, {3.864121175955885*^9, 
   3.864121254115283*^9}, {3.864121344365127*^9, 3.8641213461648903`*^9}, {
   3.8641343771628647`*^9, 3.864134391813212*^9}, 3.864134868924396*^9, {
   3.8698526678172293`*^9, 3.869852672651166*^9}, {3.8698527454872026`*^9, 
   3.869852781520359*^9}, {3.8698528282900343`*^9, 3.869852841755378*^9}, {
   3.86985291193151*^9, 3.869853049486713*^9}, {3.869853091403165*^9, 
   3.8698531430014057`*^9}, {3.869853182443825*^9, 3.869853193140706*^9}, {
   3.8698536568406143`*^9, 3.86985368994279*^9}, 3.869854366978897*^9, {
   3.869854480408565*^9, 3.869854489930223*^9}, {3.869854536585998*^9, 
   3.869854545229857*^9}, {3.8698550013078547`*^9, 3.8698553123473063`*^9}, {
   3.8698554129663754`*^9, 3.869855521571393*^9}, 3.869855602571186*^9, {
   3.869855959194372*^9, 3.869855990180665*^9}, {3.869856802327977*^9, 
   3.86985681138227*^9}, {3.869890731182519*^9, 
   3.869890742517548*^9}},ExpressionUUID->"b5f74983-fd46-40b0-9ca0-\
fe1d51e7b2a7"]
},
WindowSize->{888, 1075},
WindowMargins->{{Automatic, 0}, {Automatic, -160}},
FrontEndVersion->"12.2 for Mac OS X x86 (64-bit) (December 12, 2020)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"f2d848ac-e69b-4d2f-98da-9881f867ec53"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 30363, 623, 2306, "Input",ExpressionUUID->"b5f74983-fd46-40b0-9ca0-fe1d51e7b2a7"]
}
]
*)

